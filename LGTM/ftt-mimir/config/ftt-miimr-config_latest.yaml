##############################################################################
# 1) 공통 S3 백엔드 설정 (IAM 역할로 인증)
##############################################################################
common:
  storage:
    backend: s3
    s3:
      endpoint: s3.ap-southeast-1.amazonaws.com   # 싱가폴 리전
      region: ap-southeast-1                      # 싱가폴 리전 코드

##############################################################################
# 2) 블록 보관 기간: Compactor가 1년 지난 블록 자동 삭제
##############################################################################
limits:
  compactor_blocks_retention_period: 1y         # 1년 retention
  out_of_order_time_window: 5m                  # 최신 샘플 기준 과거 5분까지의 out-of-order 샘플만 허용

##############################################################################
# 3) 단일 노드 모드용 memberlist (빈 리스트로 다른 노드 조회 비활성화)
##############################################################################
memberlist:
  join_members: []                               # single-node 모드

##############################################################################
# 4) 블록 스토리지 (Compactor → S3)
#    • 동일 버킷 사용 시 storage_prefix 로 충돌 방지
##############################################################################
blocks_storage:
  backend: s3
  storage_prefix: blocks                         # blocks 전용 prefix
  s3:
    bucket_name: rag-mimir-pos-s3
  tsdb:
    retention_period: 24h                        # 로컬에 보관할 TSDB 블록 기간: 24시간

##############################################################################
# 5) 룰러 상태 저장 (Ruler → S3)
##############################################################################
ruler_storage:
  backend: s3
  storage_prefix: rules                          # rules 전용 prefix
  s3:
    bucket_name: rag-mimir-pos-s3

##############################################################################
# 6) Alertmanager 상태 저장 (Alertmanager → S3)
##############################################################################
alertmanager_storage:
  backend: s3
  storage_prefix: alerts                        # alerts 전용 prefix
  s3:
    bucket_name: rag-mimir-pos-s3