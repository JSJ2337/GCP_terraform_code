# Load Balancer 설정 예제
# 이 파일을 terraform.tfvars로 복사하고 실제 값을 입력하세요
# 중요: terraform.tfvars 파일은 버전 관리에 커밋하지 마세요

project_id     = "your-project-id"
project_name   = "default-templet"
environment    = "prod"
organization   = "myorg"
region_primary = "us-central1"
region_backup  = "us-east1"

# 로드 밸런서 타입
# - http: HTTP(S) Load Balancer (글로벌, 외부)
# - internal: Internal HTTP(S) Load Balancer (리전별, 내부)
# - internal_classic: Internal TCP/UDP Load Balancer (리전별, 내부)
lb_type = "http"

# 리전 및 네트워크 (Internal LB용)
region = "us-central1"
# network, subnetwork 값을 비워두면 modules/naming에서 정의한 VPC/서브넷을 사용합니다.

# 백엔드 서비스 설정
backend_protocol  = "HTTP"
backend_port_name = "http"
backend_timeout   = 30

# 백엔드 그룹
# 주의: 인스턴스 그룹에 named port가 설정되어 있어야 합니다
backends = [
  {
    group           = "projects/your-project/zones/us-central1-a/instanceGroups/web-ig"
    balancing_mode  = "UTILIZATION"
    capacity_scaler = 1.0
    description     = "Web servers"
    max_utilization = 0.8
  }
]

# 세션 친화성
session_affinity            = "NONE" # NONE, CLIENT_IP, GENERATED_COOKIE 등
affinity_cookie_ttl         = 0
connection_draining_timeout = 300

# 헬스 체크
create_health_check              = true
health_check_type                = "http" # http, https, tcp
health_check_port                = 80
health_check_request_path        = "/"
health_check_response            = ""
health_check_port_specification  = "USE_FIXED_PORT"
health_check_timeout             = 5
health_check_interval            = 10
health_check_healthy_threshold   = 2
health_check_unhealthy_threshold = 2
health_check_logging             = false

# Cloud CDN (HTTP(S) LB만 해당)
enable_cdn            = false
cdn_cache_mode        = "CACHE_ALL_STATIC"
cdn_default_ttl       = 3600
cdn_max_ttl           = 86400
cdn_client_ttl        = 3600
cdn_negative_caching  = false
cdn_serve_while_stale = 0

# Identity-Aware Proxy (HTTP(S) LB만 해당)
enable_iap = false
# IAP 활성화 시 OAuth2 클라이언트 설정
# iap_oauth2_client_id     = "your-client-id"
# iap_oauth2_client_secret = "your-client-secret"

# 로깅
enable_logging      = true
logging_sample_rate = 1.0

# URL Map (HTTP(S) LB만 해당)
host_rules    = []
path_matchers = []

# SSL (HTTP(S) LB만 해당)
use_ssl = false
# SSL 활성화 시 인증서 설정
# ssl_certificates = [
#   "projects/your-project/global/sslCertificates/your-cert"
# ]
# ssl_policy = ""

# Target Proxies (HTTP(S) LB만 해당)

# Internal LB용 포트 설정
# forwarding_rule_ports     = ["80", "443"]
# forwarding_rule_all_ports = false

# 고정 IP
create_static_ip = false
# static_ip_address = "" # 기존 IP 주소 사용 시


# ========================================
# 예제 구성
# ========================================

# 예제 1: HTTP Load Balancer (기본)
# lb_type = "http"
# backends = [
#   {
#     group = "projects/my-project/zones/us-central1-a/instanceGroups/web-ig"
#   }
# ]
# health_check_port = 80
# health_check_request_path = "/health"

# 예제 2: HTTPS Load Balancer with SSL
# lb_type = "http"
# use_ssl = true
# ssl_certificates = ["projects/my-project/global/sslCertificates/my-cert"]
# backends = [
#   {
#     group = "projects/my-project/zones/us-central1-a/instanceGroups/web-ig"
#   }
# ]

# 예제 3: Internal HTTP(S) Load Balancer
# lb_type = "internal"
# region = "us-central1"
# network = "projects/my-project/global/networks/my-vpc"
# subnetwork = "projects/my-project/regions/us-central1/subnetworks/my-subnet"
# backends = [
#   {
#     group = "projects/my-project/zones/us-central1-a/instanceGroups/internal-ig"
#   }
# ]

# 예제 4: Internal TCP Load Balancer
# lb_type = "internal_classic"
# region = "us-central1"
# network = "projects/my-project/global/networks/my-vpc"
# subnetwork = "projects/my-project/regions/us-central1/subnetworks/my-subnet"
# forwarding_rule_ports = ["80", "443"]
# backends = [
#   {
#     group = "projects/my-project/zones/us-central1-a/instanceGroups/app-ig"
#   }
# ]
# health_check_type = "tcp"
